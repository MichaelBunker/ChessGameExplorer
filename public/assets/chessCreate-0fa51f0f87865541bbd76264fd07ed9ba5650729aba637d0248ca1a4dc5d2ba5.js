var game=new Chess;statusEl=$("#status"),fenEl=$("#fen"),pgnEl=$("#pgn");var removeGreySquares=function(){$("#board .square-55d63").css("background","")},greySquare=function(a){var e=$("#board .square-"+a),n="#a9a9a9";e.hasClass("black-3c85d")===!0&&(n="#696969"),e.css("background",n)},onDragStart=function(a,e){return game.game_over()===!0||"w"===game.turn()&&-1!==e.search(/^b/)||"b"===game.turn()&&-1!==e.search(/^w/)?!1:void 0},onDrop=function(a,e){removeGreySquares();var n=game.move({from:a,to:e,promotion:"q"});if(null===n)return"snapback";updateStatus();game.moves(),game.pgn(),game.turn()},onMouseoverSquare=function(a,e){var n=game.moves({square:a,verbose:!0});if(0!==n.length){greySquare(a);for(var o=0;o<n.length;o++)greySquare(n[o].to)}},onMouseoutSquare=function(a,e){removeGreySquares()},onSnapEnd=function(){board.position(game.fen())},updateStatus=function(){var a="",e="White";"b"===game.turn()&&(e="Black"),game.in_checkmate()===!0?a="Game over, "+e+" is in checkmate.":game.in_draw()===!0?a="Game over, drawn position":(a=e+" to move",game.in_check()===!0&&(a+=", "+e+" is in check")),statusEl.html(a),fenEl.html(game.fen()),pgnEl.html(game.pgn())},cfg={draggable:!0,position:"start",onDragStart:onDragStart,onDrop:onDrop,onMouseoutSquare:onMouseoutSquare,onMouseoverSquare:onMouseoverSquare,onSnapEnd:onSnapEnd},board=ChessBoard("board",cfg);$("#startBtn").on("click",function(){board.start();new Chess("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1");updateStatus()}),$("#clearBtn").on("click",function(){board.start(),board.clear(),game.reset(),statusEl.html(""),fenEl.html(""),pgnEl.html("")}),$("#undoBtn").on("click",function(){game.undo();var a=game.fen();board.position(a),updateStatus()});